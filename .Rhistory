library(metafor)
library(scales)
library(tidyverse)
library(brms)
library(modelr)
library(tidybayes)
library(bayesplot)
library(rstan)
library(ggridges)
library(glue)
library(patchwork)
# Read csv as data frame into environment - Note: change source address
Data <- read.csv("C:/Users/James/Dropbox/Research Toolbox/Current R Data Files/Data - self selected loads.csv")
Data$study_label <- as.factor(Data$study_label)
Data$percentage_load_mean <- replmiss(Data$percentage_load_mean, with(Data, (absolute_load_mean / one_rep_max_mean) *100))
Data$prop_load <- Data$percentage_load_mean / 100
Data$prop_load_sd <- Data$percentage_load_sd / 100
# raw mean effect size
Data <- escalc(mi = prop_load, sdi = prop_load_sd, ni = ni, data = Data, measure = "MN")
# arcsine square root transformation
# https://onlinelibrary.wiley.com/doi/full/10.1002/hsr2.178
Data$prop_load_arcsine <- asin(sqrt(Data$prop_load))
Data$prop_load_arcsine_vi <- 1 / (4 * Data$ni + 2)
# logit transformation
Data$prop_load_logit <- log(Data$prop_load / (1 - Data$prop_load))
Data$prop_load_logit_vi <- 1 / (4*Data$ni)
# mean and sample size beta parameterisation variance calculation
# https://en.wikipedia.org/wiki/Beta_distribution#Variance
Data$prop_load_vi <-  Data$prop_load * (1 - Data$prop_load) / (1 + Data$ni)
### Acute studies (including first sessions from chronic studies)
Data_acute <- Data %>%
filter(acute_chronic == "acute")
Data_chronic_first <- Data %>%
filter(acute_chronic == "chronic",
session_number == 1)
Data_acute <- rbind(Data_acute, Data_chronic_first) %>%
mutate(wi = 1/sqrt(prop_load_vi),
size = 0.5 + 3 * (wi - min(wi))/(max(wi) - min(wi)))
# Descriptive Data for Session Number
Data_chronic <- Data %>%
filter(acute_chronic == "chronic") %>%
filter(prop_load <= 1) %>%
mutate(session_number = as.numeric(session_number),
prop_load_vi = prop_load_vi + 3*10^-7,
wi = 1/sqrt(prop_load_vi),
size = 0.5 + 3 * (wi - min(wi))/(max(wi) - min(wi)))
Data_chronic$number_of_reps <- replmiss(Data_chronic$number_of_reps, Data_chronic$repetitions_mean)
Data_chronic <- Data_chronic %>%
mutate(rep_group = if_else(number_of_reps <= 5, "5",
if_else(number_of_reps <= 10, "10",
if_else(number_of_reps <= 15, "15",
if_else(number_of_reps <= 20, "20", "NA")))))
list(unique(Data_chronic_first$study_label))
list(unique(Data_chronic$study_label))
list(unique(Data_acute$study_label))
### Acute studies (including first sessions from chronic studies)
Data_acute <- Data %>%
filter(acute_chronic == "acute")
list(unique(Data_acute$study_label))
